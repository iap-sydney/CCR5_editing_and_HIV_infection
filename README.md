# CCR5_KO_paper_2023
 Modeling for collaboration with Daniel Claiborne on CCR5 KO mouse model experiments.

 To generate the figures and results presented in the paper, run driver.R with all 'source' lines uncommented. This README file will outline the organization of this repository, and then explain the function of each of the codes called by driver.R. Other than the figures listed below in 'Codes called in driver.R,' all figures are generated by the analysis/03_survival_bootstrap_plotting.R code.

 # Repository Organization:
 - main folder: driver.R, setup.R, README.md, and subfolders
 - Data: contains data file used in analysis
 - processing: contains codes for importing and cleaning data
 - analysis: contains the analysis scripts
 - R_functions: contains files with functions called by analysis scripts in the analysis folder
 - output: where all output (.csv files and images) are saved

 # Codes called in driver.R:
 - setup.R: loads all R packages used in this project, defines parameters used by multiple scripts, loads functions in the R_functions folder, and creates the subfolder structure for the output folder (if it doesn't already exist).
 - processing/01_CCR5KO_data_import.R: imports the data and creates a data frame.
 - analysis/01_CCR5_KO_fitting.R: fits the various models for probability of infection as a function of % CD19+ cells with unedited CCR5 alleles to the data. This code also fits models where probability of infection is independent of CCR5 editing or identical for all animals from the same study arm.
 - analysis/02_Model_comparison_output.R: plots the relative differences in corrected AIC for each of the models fit in 01_CCR5_KO_fitting.R Figure output by this code: AIC_comparison.pdf
 - analysis/03_survival_bootstrap_plotting.R: calculates confidence intervals based on bootstrapping of the data, calculates prediction intervals for the survival curves of each study arm, and plots model output.
 - analysis/04_VL_plotting.R: plots peak viral load vs. CCR5 editing frequency. Figure output by this code: Fig7H_peakVL_v_CCR5KO_CD19.eps
 - analysis/05_Implication_plots.R: plots projected implications for various levels of CCR5 editing in people living with HIV. Figures output by this code: Fig8B_Implication_Figure.eps
